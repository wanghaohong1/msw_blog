(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{329:function(v,_,i){"use strict";i.r(_);var t=i(4),l=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"数据库与缓存实践手册"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据库与缓存实践手册"}},[v._v("#")]),v._v(" 数据库与缓存实践手册")]),v._v(" "),_("p",[v._v("数据层决定了系统的稳定性和性能上限。这里汇总关系型数据库、缓存与 NoSQL 的核心知识点以及常见实战技巧，帮助在设计与运维阶段规避风险。")]),v._v(" "),_("h2",{attrs:{id:"关系型数据库-以-mysql-为例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#关系型数据库-以-mysql-为例"}},[v._v("#")]),v._v(" 关系型数据库（以 MySQL 为例）")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("表结构设计")]),v._v(" "),_("ul",[_("li",[v._v("根据业务访问模式选择范式或反范式设计，避免过度 join。")]),v._v(" "),_("li",[v._v("关键字段使用合适的数据类型（"),_("code",[v._v("BIGINT UNSIGNED")]),v._v(" 比 "),_("code",[v._v("VARCHAR")]),v._v(" 更高效）。")]),v._v(" "),_("li",[v._v("使用 "),_("code",[v._v("comment")]),v._v(" 文档化字段含义。")])])]),v._v(" "),_("li",[_("strong",[v._v("索引策略")]),v._v(" "),_("ul",[_("li",[v._v("主键索引用于唯一标识，选择有序、稳定的字段（推荐雪花 ID 或自增 ID）。")]),v._v(" "),_("li",[v._v("覆盖索引、联合索引需考虑最左前缀原则，避免过度创建。")]),v._v(" "),_("li",[v._v("定期使用 "),_("code",[v._v("EXPLAIN")]),v._v(" 分析执行计划，关注 "),_("code",[v._v("type")]),v._v("、"),_("code",[v._v("extra")]),v._v(" 字段。")])])]),v._v(" "),_("li",[_("strong",[v._v("事务与锁")]),v._v(" "),_("ul",[_("li",[v._v("理解隔离级别（RR、RC、SERIALIZABLE）与 MVCC 原理。")]),v._v(" "),_("li",[v._v("常见锁：行锁、间隙锁、临键锁；通过加索引减少锁粒度。")]),v._v(" "),_("li",[v._v("使用 "),_("code",[v._v("select ... for update")]),v._v(" 时注意索引命中，避免全表锁。")])])]),v._v(" "),_("li",[_("strong",[v._v("性能优化")]),v._v(" "),_("ul",[_("li",[v._v("合理配置连接池参数（maxActive、maxIdle、maxWait）。")]),v._v(" "),_("li",[v._v("对慢查询收集统计信息，将高频写操作拆分异步或批处理。")]),v._v(" "),_("li",[v._v("使用分库分表或读写分离时，确保 ID 唯一性与全局事务策略。")])])])]),v._v(" "),_("h2",{attrs:{id:"缓存体系-redis-为例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#缓存体系-redis-为例"}},[v._v("#")]),v._v(" 缓存体系（Redis 为例）")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("数据结构与场景")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("String")]),v._v(" 存储简单 KV，"),_("code",[v._v("Hash")]),v._v(" 适合对象，"),_("code",[v._v("SortedSet")]),v._v(" 用于排行榜。")]),v._v(" "),_("li",[v._v("利用 HyperLogLog、Bitmap 进行统计类需求。")])])]),v._v(" "),_("li",[_("strong",[v._v("缓存策略")]),v._v(" "),_("ul",[_("li",[v._v("缓存穿透：设置空值缓存或使用布隆过滤器。")]),v._v(" "),_("li",[v._v("缓存击穿：对热点 key 加互斥锁或使用逻辑过期策略。")]),v._v(" "),_("li",[v._v("缓存雪崩：设置随机过期时间、分散刷新时间点。")])])]),v._v(" "),_("li",[_("strong",[v._v("持久化与高可用")]),v._v(" "),_("ul",[_("li",[v._v("RDB 快照与 AOF 结合，权衡性能与数据安全。")]),v._v(" "),_("li",[v._v("主从复制 + Sentinel 或 Redis Cluster 实现故障自动切换。")]),v._v(" "),_("li",[v._v("评估内存占用，避免 big key 阻塞主线程。")])])])]),v._v(" "),_("h2",{attrs:{id:"nosql-与搜索引擎"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#nosql-与搜索引擎"}},[v._v("#")]),v._v(" NoSQL 与搜索引擎")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("MongoDB")]),v._v(" "),_("ul",[_("li",[v._v("适合文档型、灵活 schema 场景，选用合适的 "),_("code",[v._v("shard key")]),v._v("。")]),v._v(" "),_("li",[v._v("熟悉副本集、分片集群的部署与备份策略。")])])]),v._v(" "),_("li",[_("strong",[v._v("ElasticSearch")]),v._v(" "),_("ul",[_("li",[v._v("用于全文检索与复杂查询，理解倒排索引、分片与副本机制。")]),v._v(" "),_("li",[v._v("编写合理的 mapping，避免字段类型频繁变更。")]),v._v(" "),_("li",[v._v("配合 Logstash/Filebeat 实现日志集中分析。")])])])]),v._v(" "),_("h2",{attrs:{id:"数据治理与安全"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#数据治理与安全"}},[v._v("#")]),v._v(" 数据治理与安全")]),v._v(" "),_("ul",[_("li",[v._v("数据权限：按照最小权限原则管理账号，生产环境禁止直连。")]),v._v(" "),_("li",[v._v("定期备份与演练恢复流程，备份和恢复都要经过压测验证。")]),v._v(" "),_("li",[v._v("敏感信息脱敏存储，使用 AES、SM4 等算法加密。")]),v._v(" "),_("li",[v._v("建立数据审计日志，记录 DDL/DML 操作来源与影响范围。")])]),v._v(" "),_("h2",{attrs:{id:"常见组合策略"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#常见组合策略"}},[v._v("#")]),v._v(" 常见组合策略")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("读多写少业务")]),v._v("：数据库 + 多级缓存（本地 Caffeine + Redis）。")]),v._v(" "),_("li",[_("strong",[v._v("高并发写入")]),v._v("：消息队列削峰，异步写库，结合批量提交。")]),v._v(" "),_("li",[_("strong",[v._v("全局搜索")]),v._v("：MySQL 作为主存，ElasticSearch 提供检索，定期校验一致性。")]),v._v(" "),_("li",[_("strong",[v._v("分析报表")]),v._v("：OLTP 与 OLAP 分离，实时同步到 ClickHouse、Doris 等列式存储。")])]),v._v(" "),_("h2",{attrs:{id:"自查清单"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#自查清单"}},[v._v("#")]),v._v(" 自查清单")]),v._v(" "),_("ul",[_("li",[v._v("新建表是否包含主键、创建时间、更新时间、唯一键约束？")]),v._v(" "),_("li",[v._v("SQL 是否经过 "),_("code",[v._v("EXPLAIN")]),v._v(" 与慢查询分析？索引利用率是否达标？")]),v._v(" "),_("li",[v._v("缓存是否具备监控告警、命中率统计与过期策略？")]),v._v(" "),_("li",[v._v("宕机恢复流程是否经过演练，恢复时间与数据损失可接受吗？")])]),v._v(" "),_("h2",{attrs:{id:"推荐资料"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#推荐资料"}},[v._v("#")]),v._v(" 推荐资料")]),v._v(" "),_("ul",[_("li",[v._v("《高性能 MySQL（第 4 版）》《Redis 设计与实现》")]),v._v(" "),_("li",[v._v("极客时间《MySQL 45 讲》《从零开始学架构》")]),v._v(" "),_("li",[v._v("Redis 官方文档与 "),_("code",[v._v("redis.io/commands")])]),v._v(" "),_("li",[v._v("Elastic 官方博客与实践案例（Logging、APM、Security）")])])])}),[],!1,null,null,null);_.default=l.exports}}]);