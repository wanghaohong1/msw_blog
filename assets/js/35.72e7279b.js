(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{335:function(v,_,t){"use strict";t.r(_);var l=t(4),s=Object(l.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"典型故障案例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#典型故障案例"}},[v._v("#")]),v._v(" 典型故障案例")]),v._v(" "),_("p",[v._v("记录线上高频异常场景，覆盖告警信号、定位手段与长期改进措施。")]),v._v(" "),_("h2",{attrs:{id:"案例一-缓存雪崩导致接口超时"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#案例一-缓存雪崩导致接口超时"}},[v._v("#")]),v._v(" 案例一：缓存雪崩导致接口超时")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("背景")]),v._v("：Redis 大量热点 Key 同时过期，后端瞬时打到数据库，QPS 猛增。")]),v._v(" "),_("li",[_("strong",[v._v("现象")]),v._v("：请求延迟 >5s，Redis 命中率骤降，数据库 CPU 飙升。")]),v._v(" "),_("li",[_("strong",[v._v("定位过程")]),v._v("：\n"),_("ol",[_("li",[v._v("Prometheus 指标显示缓存命中率下降、DB QPS 上升。")]),v._v(" "),_("li",[v._v("Redis "),_("code",[v._v("info stats")]),v._v(" 显示大量 "),_("code",[v._v("miss")]),v._v("，数据库慢查询堆积。")]),v._v(" "),_("li",[v._v("分析后确认批量设置了相同过期时间。")])])]),v._v(" "),_("li",[_("strong",[v._v("处理动作")]),v._v("：临时扩容数据库连接池，手动热点数据预热，引入互斥锁刷新。")]),v._v(" "),_("li",[_("strong",[v._v("改进措施")]),v._v("：为热点缓存增加随机过期、引入本地缓存兜底、实现缓存刷新任务。")])]),v._v(" "),_("h2",{attrs:{id:"案例二-数据库死锁导致订单创建失败"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#案例二-数据库死锁导致订单创建失败"}},[v._v("#")]),v._v(" 案例二：数据库死锁导致订单创建失败")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("背景")]),v._v("：两条订单流程同时更新库存与优惠券，SQL 执行顺序不同引发死锁。")]),v._v(" "),_("li",[_("strong",[v._v("现象")]),v._v("：接口返回 500，日志出现 "),_("code",[v._v("Deadlock found when trying to get lock")]),v._v("。")]),v._v(" "),_("li",[_("strong",[v._v("定位过程")]),v._v("：\n"),_("ol",[_("li",[v._v("通过 APM 捕获异常堆栈，定位到库存更新 SQL。")]),v._v(" "),_("li",[v._v("执行 "),_("code",[v._v("show engine innodb status\\G")]),v._v(" 查看死锁信息，确认两事务互相等待。")]),v._v(" "),_("li",[v._v("排查代码发现事务中 SQL 顺序不一致。")])])]),v._v(" "),_("li",[_("strong",[v._v("处理动作")]),v._v("：将涉及库存与优惠券操作的 SQL 顺序统一；短期增加重试机制。")]),v._v(" "),_("li",[_("strong",[v._v("改进措施")]),v._v("：引入库存服务化接口，关键资源使用分布式锁，规范事务访问顺序。")])]),v._v(" "),_("h2",{attrs:{id:"案例三-消息队列堆积导致数据延迟"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#案例三-消息队列堆积导致数据延迟"}},[v._v("#")]),v._v(" 案例三：消息队列堆积导致数据延迟")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("背景")]),v._v("：促销活动引发订单量暴增，消费端处理能力不足。")]),v._v(" "),_("li",[_("strong",[v._v("现象")]),v._v("：Kafka lag 急剧上升，延迟超过 10 分钟，业务报警。")]),v._v(" "),_("li",[_("strong",[v._v("定位过程")]),v._v("：\n"),_("ol",[_("li",[v._v("监控显示消费速率明显低于生产速率。")]),v._v(" "),_("li",[v._v("查看消费者日志，有大量数据库写入慢导致消费阻塞。")]),v._v(" "),_("li",[v._v("数据库查询慢日志显示新增索引缺失。")])])]),v._v(" "),_("li",[_("strong",[v._v("处理动作")]),v._v("：临时扩容消费者实例，分摊压力；对数据库新增索引、优化写入逻辑。")]),v._v(" "),_("li",[_("strong",[v._v("改进措施")]),v._v("：扩展异步处理能力，增加按流量自动伸缩策略，提前压测访问路径。")])]),v._v(" "),_("h2",{attrs:{id:"案例四-jvm-内存泄漏导致频繁-full-gc"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#案例四-jvm-内存泄漏导致频繁-full-gc"}},[v._v("#")]),v._v(" 案例四：JVM 内存泄漏导致频繁 Full GC")]),v._v(" "),_("ul",[_("li",[_("strong",[v._v("背景")]),v._v("：新上线功能使用 ThreadLocal 缓存大对象但未清理。")]),v._v(" "),_("li",[_("strong",[v._v("现象")]),v._v("：应用内存持续增长，GC 日志显示 Full GC 间隔缩短。")]),v._v(" "),_("li",[_("strong",[v._v("定位过程")]),v._v("：\n"),_("ol",[_("li",[v._v("通过 Prometheus 监控发现 Old 区占用接近 90%。")]),v._v(" "),_("li",[v._v("使用 "),_("code",[v._v("arthas heapdump")]),v._v("，借助 MAT 分析 Dominator Tree，定位到 ThreadLocalMap。")]),v._v(" "),_("li",[v._v("代码审查发现 ThreadLocal 未在 finally 中清理。")])])]),v._v(" "),_("li",[_("strong",[v._v("处理动作")]),v._v("：热修复更新 ThreadLocal 使用方式并重启实例。")]),v._v(" "),_("li",[_("strong",[v._v("改进措施")]),v._v("：引入内存监测告警、代码评审检查 ThreadLocal 使用规范、增加自动化内存回归测试。")])])])}),[],!1,null,null,null);_.default=s.exports}}]);