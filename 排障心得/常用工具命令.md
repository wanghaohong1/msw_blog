# 常用工具命令

> 快速复用排障常用命令，建议结合脚本仓库维护。

## 操作系统
- 查看进程资源：`top -Hp <pid>`、`pidstat -p <pid> 1`
- 网络连接：`ss -ltnp`、`telnet host port`、`curl -Iv`
- 磁盘空间：`df -h`、`du -sh * | sort -h`
- 文件监控：`tail -f app.log`、`multitail`、`grep -R "keyword"`

## JVM 应用
- 线程堆栈：`jstack -l <pid>`
- 堆内存快照：`jmap -dump:format=b,file=heap.hprof <pid>`
- 实时监控：`jstat -gcutil <pid> 1000`、`arthas` (`dashboard`, `thread`, `trace`)
- 在线修改日志级别：`arthas logger --name ROOT --level debug`

## 数据库（MySQL）
- 连接状态：`show processlist;`
- 慢查询：`show variables like 'slow_query%';`、`show global status like 'Slow_queries';`
- 锁等待：`show engine innodb status\G`
- 备份恢复：`mysqldump -h host -u user -p db table > backup.sql`

## Redis
- 键统计：`info keyspace`、`dbsize`
- 慢查询：`slowlog get`、`latency latest`
- 主从状态：`info replication`
- 集群检查：`redis-cli -c cluster nodes`

## Kafka
- 消费积压：`kafka-consumer-groups.sh --describe --group xxx`
- Topic 列表：`kafka-topics.sh --list`
- 查看分区偏移：`kafka-run-class kafka.tools.GetOffsetShell --topic xxx --time -1`
- 发送测试消息：`kafka-console-producer.sh --topic xxx --broker-list host:9092`

## Kubernetes
- 查看 Pod 状态：`kubectl get pods -n ns --watch`
- 日志追踪：`kubectl logs pod -n ns --tail=200 -f`
- 进入容器：`kubectl exec -it pod -n ns -- bash`
- 回滚部署：`kubectl rollout undo deployment/<name> -n ns`

> 建议将以上命令整理为脚本或别名，并配合权限控制、审计记录使用。***

