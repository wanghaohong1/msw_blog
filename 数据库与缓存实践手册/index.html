<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>数据库与缓存实践手册 | 迷死王的学习笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/msw_blog/favicon.ico">
    <meta name="description" content="记录学习路线与项目实战的个人技术博客">
    <meta property="article:modified_time" content="2025-12-14T13:52:44.000Z">
    <meta property="og:site_name" content="迷死王的学习笔记">
    <meta property="og:title" content="数据库与缓存实践手册">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://wanghaohong1.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/">
    <meta name="twitter:title" content="数据库与缓存实践手册">
    <meta name="twitter:url" content="https://wanghaohong1.github.io/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="学习笔记, 项目实战, 编程路线">
    <meta property="article:tag" content="学习笔记">
    <meta name="keywords" content="学习笔记, 编程路线, 项目实战, 技术分享, 前端, 后端, 算法">
    <meta name="author" content="迷死王">
    
    <link rel="preload" href="/msw_blog/assets/css/0.styles.073179c2.css" as="style"><link rel="preload" href="/msw_blog/assets/js/app.26b3379e.js" as="script"><link rel="preload" href="/msw_blog/assets/js/2.6131818a.js" as="script"><link rel="preload" href="/msw_blog/assets/js/33.5f18b75e.js" as="script"><link rel="prefetch" href="/msw_blog/assets/js/1.772e8449.js"><link rel="prefetch" href="/msw_blog/assets/js/10.40b6837e.js"><link rel="prefetch" href="/msw_blog/assets/js/11.78a8555f.js"><link rel="prefetch" href="/msw_blog/assets/js/12.a6f096db.js"><link rel="prefetch" href="/msw_blog/assets/js/13.8352f638.js"><link rel="prefetch" href="/msw_blog/assets/js/14.c7dc96c5.js"><link rel="prefetch" href="/msw_blog/assets/js/15.970a8ca5.js"><link rel="prefetch" href="/msw_blog/assets/js/16.ac3baac4.js"><link rel="prefetch" href="/msw_blog/assets/js/17.c186ca40.js"><link rel="prefetch" href="/msw_blog/assets/js/18.d0f0bd51.js"><link rel="prefetch" href="/msw_blog/assets/js/19.5740e4d6.js"><link rel="prefetch" href="/msw_blog/assets/js/20.8885a4fa.js"><link rel="prefetch" href="/msw_blog/assets/js/21.2a33c70e.js"><link rel="prefetch" href="/msw_blog/assets/js/22.3e8347a6.js"><link rel="prefetch" href="/msw_blog/assets/js/23.ceb5a5ff.js"><link rel="prefetch" href="/msw_blog/assets/js/24.ae67f00c.js"><link rel="prefetch" href="/msw_blog/assets/js/25.15e1f641.js"><link rel="prefetch" href="/msw_blog/assets/js/26.35b2bbdc.js"><link rel="prefetch" href="/msw_blog/assets/js/27.dbf349d5.js"><link rel="prefetch" href="/msw_blog/assets/js/28.8f00d96e.js"><link rel="prefetch" href="/msw_blog/assets/js/29.25c47678.js"><link rel="prefetch" href="/msw_blog/assets/js/3.4dc033c7.js"><link rel="prefetch" href="/msw_blog/assets/js/30.50536117.js"><link rel="prefetch" href="/msw_blog/assets/js/31.eefba490.js"><link rel="prefetch" href="/msw_blog/assets/js/32.b5a86f29.js"><link rel="prefetch" href="/msw_blog/assets/js/34.5c4f8a55.js"><link rel="prefetch" href="/msw_blog/assets/js/35.a3157f78.js"><link rel="prefetch" href="/msw_blog/assets/js/36.26e14205.js"><link rel="prefetch" href="/msw_blog/assets/js/37.539fd58b.js"><link rel="prefetch" href="/msw_blog/assets/js/38.3b7ef5ec.js"><link rel="prefetch" href="/msw_blog/assets/js/39.d5f0b241.js"><link rel="prefetch" href="/msw_blog/assets/js/4.2f502b73.js"><link rel="prefetch" href="/msw_blog/assets/js/40.a3b60799.js"><link rel="prefetch" href="/msw_blog/assets/js/41.b2c43a5e.js"><link rel="prefetch" href="/msw_blog/assets/js/42.1a7b9b2a.js"><link rel="prefetch" href="/msw_blog/assets/js/5.7b1f056c.js"><link rel="prefetch" href="/msw_blog/assets/js/6.056886f1.js"><link rel="prefetch" href="/msw_blog/assets/js/7.a96cecf9.js"><link rel="prefetch" href="/msw_blog/assets/js/vendors~docsearch.9f962556.js">
    <link rel="stylesheet" href="/msw_blog/assets/css/0.styles.073179c2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/msw_blog/" class="home-link router-link-active"><img src="/msw_blog/logo.png" alt="迷死王的学习笔记" class="logo"> <span class="site-name can-hide">迷死王的学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/msw_blog/学习笔记/" class="nav-link">
  学习笔记
</a></div><div class="nav-item"><a href="/msw_blog/知识碎片/" class="nav-link">
  知识碎片
</a></div><div class="nav-item"><a href="/msw_blog/排障心得/" class="nav-link">
  排障心得
</a></div><div class="nav-item"><a href="/msw_blog/项目实战/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/msw_blog/作者/" class="nav-link">
  作者
</a></div> <a href="https://github.com/wanghaohong1/wanghaohong1.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/msw_blog/学习笔记/" class="nav-link">
  学习笔记
</a></div><div class="nav-item"><a href="/msw_blog/知识碎片/" class="nav-link">
  知识碎片
</a></div><div class="nav-item"><a href="/msw_blog/排障心得/" class="nav-link">
  排障心得
</a></div><div class="nav-item"><a href="/msw_blog/项目实战/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/msw_blog/作者/" class="nav-link">
  作者
</a></div> <a href="https://github.com/wanghaohong1/wanghaohong1.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据库与缓存实践手册</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#关系型数据库-以-mysql-为例" class="sidebar-link">关系型数据库（以 MySQL 为例）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#缓存体系-redis-为例" class="sidebar-link">缓存体系（Redis 为例）</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#nosql-与搜索引擎" class="sidebar-link">NoSQL 与搜索引擎</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#数据治理与安全" class="sidebar-link">数据治理与安全</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#常见组合策略" class="sidebar-link">常见组合策略</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#自查清单" class="sidebar-link">自查清单</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#推荐资料" class="sidebar-link">推荐资料</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="content"><div style="width:100%"><div class="theme-default-content custom-content content__default"><h1 id="数据库与缓存实践手册"><a href="#数据库与缓存实践手册" class="header-anchor">#</a> 数据库与缓存实践手册</h1> <p>数据层决定了系统的稳定性和性能上限。这里汇总关系型数据库、缓存与 NoSQL 的核心知识点以及常见实战技巧，帮助在设计与运维阶段规避风险。</p> <h2 id="关系型数据库-以-mysql-为例"><a href="#关系型数据库-以-mysql-为例" class="header-anchor">#</a> 关系型数据库（以 MySQL 为例）</h2> <ul><li><strong>表结构设计</strong> <ul><li>根据业务访问模式选择范式或反范式设计，避免过度 join。</li> <li>关键字段使用合适的数据类型（<code>BIGINT UNSIGNED</code> 比 <code>VARCHAR</code> 更高效）。</li> <li>使用 <code>comment</code> 文档化字段含义。</li></ul></li> <li><strong>索引策略</strong> <ul><li>主键索引用于唯一标识，选择有序、稳定的字段（推荐雪花 ID 或自增 ID）。</li> <li>覆盖索引、联合索引需考虑最左前缀原则，避免过度创建。</li> <li>定期使用 <code>EXPLAIN</code> 分析执行计划，关注 <code>type</code>、<code>extra</code> 字段。</li></ul></li> <li><strong>事务与锁</strong> <ul><li>理解隔离级别（RR、RC、SERIALIZABLE）与 MVCC 原理。</li> <li>常见锁：行锁、间隙锁、临键锁；通过加索引减少锁粒度。</li> <li>使用 <code>select ... for update</code> 时注意索引命中，避免全表锁。</li></ul></li> <li><strong>性能优化</strong> <ul><li>合理配置连接池参数（maxActive、maxIdle、maxWait）。</li> <li>对慢查询收集统计信息，将高频写操作拆分异步或批处理。</li> <li>使用分库分表或读写分离时，确保 ID 唯一性与全局事务策略。</li></ul></li></ul> <h2 id="缓存体系-redis-为例"><a href="#缓存体系-redis-为例" class="header-anchor">#</a> 缓存体系（Redis 为例）</h2> <ul><li><strong>数据结构与场景</strong> <ul><li><code>String</code> 存储简单 KV，<code>Hash</code> 适合对象，<code>SortedSet</code> 用于排行榜。</li> <li>利用 HyperLogLog、Bitmap 进行统计类需求。</li></ul></li> <li><strong>缓存策略</strong> <ul><li>缓存穿透：设置空值缓存或使用布隆过滤器。</li> <li>缓存击穿：对热点 key 加互斥锁或使用逻辑过期策略。</li> <li>缓存雪崩：设置随机过期时间、分散刷新时间点。</li></ul></li> <li><strong>持久化与高可用</strong> <ul><li>RDB 快照与 AOF 结合，权衡性能与数据安全。</li> <li>主从复制 + Sentinel 或 Redis Cluster 实现故障自动切换。</li> <li>评估内存占用，避免 big key 阻塞主线程。</li></ul></li></ul> <h2 id="nosql-与搜索引擎"><a href="#nosql-与搜索引擎" class="header-anchor">#</a> NoSQL 与搜索引擎</h2> <ul><li><strong>MongoDB</strong> <ul><li>适合文档型、灵活 schema 场景，选用合适的 <code>shard key</code>。</li> <li>熟悉副本集、分片集群的部署与备份策略。</li></ul></li> <li><strong>ElasticSearch</strong> <ul><li>用于全文检索与复杂查询，理解倒排索引、分片与副本机制。</li> <li>编写合理的 mapping，避免字段类型频繁变更。</li> <li>配合 Logstash/Filebeat 实现日志集中分析。</li></ul></li></ul> <h2 id="数据治理与安全"><a href="#数据治理与安全" class="header-anchor">#</a> 数据治理与安全</h2> <ul><li>数据权限：按照最小权限原则管理账号，生产环境禁止直连。</li> <li>定期备份与演练恢复流程，备份和恢复都要经过压测验证。</li> <li>敏感信息脱敏存储，使用 AES、SM4 等算法加密。</li> <li>建立数据审计日志，记录 DDL/DML 操作来源与影响范围。</li></ul> <h2 id="常见组合策略"><a href="#常见组合策略" class="header-anchor">#</a> 常见组合策略</h2> <ul><li><strong>读多写少业务</strong>：数据库 + 多级缓存（本地 Caffeine + Redis）。</li> <li><strong>高并发写入</strong>：消息队列削峰，异步写库，结合批量提交。</li> <li><strong>全局搜索</strong>：MySQL 作为主存，ElasticSearch 提供检索，定期校验一致性。</li> <li><strong>分析报表</strong>：OLTP 与 OLAP 分离，实时同步到 ClickHouse、Doris 等列式存储。</li></ul> <h2 id="自查清单"><a href="#自查清单" class="header-anchor">#</a> 自查清单</h2> <ul><li>新建表是否包含主键、创建时间、更新时间、唯一键约束？</li> <li>SQL 是否经过 <code>EXPLAIN</code> 与慢查询分析？索引利用率是否达标？</li> <li>缓存是否具备监控告警、命中率统计与过期策略？</li> <li>宕机恢复流程是否经过演练，恢复时间与数据损失可接受吗？</li></ul> <h2 id="推荐资料"><a href="#推荐资料" class="header-anchor">#</a> 推荐资料</h2> <ul><li>《高性能 MySQL（第 4 版）》《Redis 设计与实现》</li> <li>极客时间《MySQL 45 讲》《从零开始学架构》</li> <li>Redis 官方文档与 <code>redis.io/commands</code></li> <li>Elastic 官方博客与实践案例（Logging、APM、Security）</li></ul></div> <footer class="page-edit" style="margin:0;"><div class="edit-link"><a href="https://github.com/wanghaohong1/wanghaohong1.github.io/edit/main/学习笔记/数据库与缓存实践手册.md" target="_blank" rel="noopener noreferrer">完善文章</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最近更新:</span> <span class="time">12/14/2025, 1:52:44 PM</span></div></footer> <!----></div> <div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:86vh"><div style="font-weight:bold;">数据库与缓存实践手册</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#关系型数据库-以-mysql-为例" class="toc-sidebar-link">关系型数据库（以 MySQL 为例）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#缓存体系-redis-为例" class="toc-sidebar-link">缓存体系（Redis 为例）</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#nosql-与搜索引擎" class="toc-sidebar-link">NoSQL 与搜索引擎</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#数据治理与安全" class="toc-sidebar-link">数据治理与安全</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#常见组合策略" class="toc-sidebar-link">常见组合策略</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#自查清单" class="toc-sidebar-link">自查清单</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/msw_blog/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%AE%9E%E8%B7%B5%E6%89%8B%E5%86%8C/#推荐资料" class="toc-sidebar-link">推荐资料</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div>  <main class="footer"> <div class="copy-right"><span class="name"> 编程导航   |     </span> <a target="_blank" rel="noreferrer">
          
        </a></div></main></main> <aside class="page-sidebar"> <div class="page-side-toolbar"></div>  </aside></div><div class="global-ui"><!----></div></div>
    <script src="/msw_blog/assets/js/app.26b3379e.js" defer></script><script src="/msw_blog/assets/js/2.6131818a.js" defer></script><script src="/msw_blog/assets/js/33.5f18b75e.js" defer></script>
  </body>
</html>
