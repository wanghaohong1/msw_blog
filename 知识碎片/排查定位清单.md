# 排查定位清单

> 当线上出现故障时，从观测到定位再到恢复的标准动作清单。

## 1. 快速确认现场
- 收集告警信息：触发时间、触发指标。
- 确认影响范围：受影响服务、用户、关键路径。
- 记录近期变更：发布、配置、基础设施操作。

## 2. 指标与日志
- 业务指标：QPS、响应时延、错误率。
- 系统指标：CPU、内存、磁盘、网络吞吐。
- 应用日志：按 TraceId/RequestId 聚合，关注 ERROR/ WARN。
- 中间件日志：数据库慢查询、Redis 超时、MQ 积压。

## 3. 常见故障路径

| 症状 | 优先排查 | 典型方案 |
| --- | --- | --- |
| 延迟升高 | 线程池耗尽、GC 频繁、下游超时 | 调整线程池、降级非核心、扩容下游 |
| 错误率飙升 | 服务依赖不可达、配置错误 | 回滚配置、切换备用节点、启用降级 |
| QPS 暴涨 | 接口被刷、热点数据 | 开启限流、热点缓存预热 |
| CPU 100% | 死循环、Full GC、热点方法 | 抓取线程栈、分析 GC 日志、热点优化 |
| 内存飙升 | 对象泄漏、大量缓存 | heapdump 分析、限制缓存上限 |

## 4. 恢复与验证
- 制定临时止血方案：限流、降级、熔断。
- 若需回滚：确认版本、依赖和数据库兼容性。
- 恢复后观察：监控指标恢复、日志趋稳、告警解除。
- 记录时间线：故障发现、处理动作、恢复确认。

## 5. 复盘输出
- 原因分类：需求、代码、配置、资源、流程。
- 防御措施：完善监控、预警阈值、自动化脚本。
- 知识沉淀：将问题及解决思路纳入知识库。

